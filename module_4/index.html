<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart</title>
    <link rel="stylesheet" href="dist/output.css" />
    <link
      rel="stylesheet"
      href="node_modules/@fortawesome/fontawesome-free/css/all.css"
    />
  </head>

  <body data-theme="cupcake">
    <div class="navbar bg-blend-darken">
      <div class="flex-1">
        <a class="btn btn-ghost normal-case text-xl">My Shopping Cart</a>
      </div>

      <div class="flex-none">
        <div class="dropdown dropdown-end">
          <label tabindex="0" class="btn btn-ghost btn-circle avatar">
            <div class="w-10 rounded-full">
              <img src="/assets/images/avatar.png" />
            </div>
          </label>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52"
          >
            <li>
              <a class="justify-between">
                Profile
                <span class="badge">New</span>
              </a>
            </li>
            <li><a>Settings</a></li>
            <li><a>Logout</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="carousel w-full">
      <div id="slide1" class="carousel-item relative w-full">
        <img src="./assets/images/banner-bg.jpg" class="w-full" />
        <div
          class="absolute flex justify-between transform -translate-y-1/2 left-5 right-5 top-1/2"
        >
          <a href="#slide1" class="btn btn-circle">❮</a>
          <a href="#slide2" class="btn btn-circle">❯</a>
        </div>
      </div>
      <div id="slide2" class="carousel-item relative w-full">
        <img src="./assets/images/offer.jpg" class="w-full" />
        <div
          class="absolute flex justify-between transform -translate-y-1/2 left-5 right-5 top-1/2"
        >
          <a href="#slide1" class="btn btn-circle">❮</a>
          <a href="#slide2" class="btn btn-circle">❯</a>
        </div>
      </div>
    </div>

    <!-- related product -->
    <div class="container mb-16 m-auto my-5">
      <h2 class="text-2xl font-medium text-gray-800 uppercase mb-6">
        Product's Gallery
      </h2>

      <div
        class="grid grid-cols-2 gap-4 md:grid-cols-6"
        id="productContent"
      ></div>
    </div>
    <!-- ./related product -->

    <!-- footer -->
    <footer class="bg-white pt-16 pb-12 border-t border-gray-100">
      <div class="container grid grid-cols-3 m-auto">
        <div class="col-span-1 space-y-8 mr-2">
          <h1>My Shopping Cart</h1>

          <div class="mr-2">
            <p class="text-gray-500">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Quia,
              hic?
            </p>
          </div>
          <div class="flex space-x-6">
            <a href="#" class="text-gray-400 hover:text-gray-500"
              ><i class="fa-brands fa-facebook-square"></i
            ></a>
            <a href="#" class="text-gray-400 hover:text-gray-500"
              ><i class="fa-brands fa-instagram-square"></i
            ></a>
            <a href="#" class="text-gray-400 hover:text-gray-500"
              ><i class="fa-brands fa-twitter-square"></i
            ></a>
            <a href="#" class="text-gray-400 hover:text-gray-500">
              <i class="fa-brands fa-github-square"></i>
            </a>
          </div>
        </div>

        <div class="col-span-2 grid grid-cols-2 gap-8">
          <div class="grid grid-cols-2 gap-8">
            <div>
              <h3
                class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
              >
                Solutions
              </h3>
              <div class="mt-4 space-y-4">
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Marketing</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Analitycs</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Commerce</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Insights</a
                >
              </div>
            </div>

            <div>
              <h3
                class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
              >
                Support
              </h3>
              <div class="mt-4 space-y-4">
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Pricing</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Documentation</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Guides</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >API Status</a
                >
              </div>
            </div>
          </div>
          <div class="grid grid-cols-2 gap-8">
            <div>
              <h3
                class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
              >
                Solutions
              </h3>
              <div class="mt-4 space-y-4">
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Marketing</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Analitycs</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Commerce</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Insights</a
                >
              </div>
            </div>

            <div>
              <h3
                class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
              >
                Support
              </h3>
              <div class="mt-4 space-y-4">
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Pricing</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Documentation</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >Guides</a
                >
                <a
                  href="#"
                  class="text-base text-gray-500 hover:text-gray-900 block"
                  >API Status</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- ./footer -->

    <!-- copyright -->
    <div class="bg-gray-800 py-4">
      <div class="container m-auto flex items-center justify-between">
        <p class="text-white">&copy; Md.Hasanat Zamil - All Right Reserved</p>
        <div>Payment Cards images</div>
      </div>
    </div>
    <!-- ./copyright -->
    <!-- ./shopping cart -->
    <div class="relative z-10 hidden" id="rightShoppingCart">
      aria-labelledby="slide-over-title" role="dialog" aria-modal="true" >
      <!--
        Background backdrop, show/hide based on slide-over state.
    
        Entering: "ease-in-out duration-500"
          From: "opacity-0"
          To: "opacity-100"
        Leaving: "ease-in-out duration-500"
          From: "opacity-100"
          To: "opacity-0"
      -->
      <div
        class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
        id="rightShoppingCartOpacity"
      ></div>

      <div class="fixed inset-0 overflow-hidden">
        <div class="absolute inset-0 overflow-hidden">
          <div
            class="pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10"
          >
            <!--
              Slide-over panel, show/hide based on slide-over state.
    
              Entering: "transform transition ease-in-out duration-500 sm:duration-700"
                From: "translate-x-full"
                To: "translate-x-0"
              Leaving: "transform transition ease-in-out duration-500 sm:duration-700"
                From: "translate-x-0"
                To: "translate-x-full"
            -->
            <div class="pointer-events-auto w-screen max-w-md">
              <div
                class="flex h-full flex-col overflow-y-scroll bg-white shadow-xl"
              >
                <div class="flex-1 overflow-y-auto px-4 py-6 sm:px-6">
                  <div class="flex items-start justify-between">
                    <h2
                      class="text-lg font-medium text-gray-900"
                      id="slide-over-title"
                    >
                      Shopping cart
                    </h2>
                    <div class="ml-3 flex h-7 items-center">
                      <button
                        id="closeCart"
                        type="button"
                        class="-m-2 p-2 text-gray-400 hover:text-gray-500"
                      >
                        <span class="sr-only">Close panel</span>
                        <svg
                          class="h-6 w-6"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          aria-hidden="true"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M6 18L18 6M6 6l12 12"
                          />
                        </svg>
                      </button>
                    </div>
                  </div>

                  <div class="mt-8">
                    <div class="flow-root">
                      <ul
                        role="list"
                        class="-my-6 divide-y divide-gray-200 show-cart"
                      >
                        <li class="flex py-6">
                          <div
                            class="h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200"
                          >
                            <img
                              src="https://tailwindui.com/img/ecommerce-images/shopping-cart-page-04-product-01.jpg"
                              alt="Salmon orange fabric pouch with match zipper, gray zipper pull, and adjustable hip belt."
                              class="h-full w-full object-cover object-center"
                            />
                          </div>

                          <div class="ml-4 flex flex-1 flex-col">
                            <div>
                              <div
                                class="flex justify-between text-base font-medium text-gray-900"
                              >
                                <h3>
                                  <a href="#">Throwback Hip Bag</a>
                                </h3>
                                <p class="ml-4">$90.00</p>
                              </div>
                              <p class="mt-1 text-sm text-gray-500">Salmon</p>
                            </div>
                            <div
                              class="flex flex-1 items-end justify-between text-sm"
                            >
                              <p class="text-gray-500">Qty 1</p>

                              <div class="flex">
                                <button
                                  type="button"
                                  class="font-medium text-indigo-600 hover:text-indigo-500"
                                >
                                  Remove
                                </button>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="flex py-6">
                          <div
                            class="h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200"
                          >
                            <img
                              src="https://tailwindui.com/img/ecommerce-images/shopping-cart-page-04-product-02.jpg"
                              alt="Front of satchel with blue canvas body, black straps and handle, drawstring top, and front zipper pouch."
                              class="h-full w-full object-cover object-center"
                            />
                          </div>

                          <div class="ml-4 flex flex-1 flex-col">
                            <div>
                              <div
                                class="flex justify-between text-base font-medium text-gray-900"
                              >
                                <h3>
                                  <a href="#">Medium Stuff Satchel</a>
                                </h3>
                                <p class="ml-4">$32.00</p>
                              </div>
                              <p class="mt-1 text-sm text-gray-500">Blue</p>
                            </div>
                            <div
                              class="flex flex-1 items-end justify-between text-sm"
                            >
                              <p class="text-gray-500">Qty 1</p>

                              <div class="flex">
                                <button
                                  type="button"
                                  class="font-medium text-indigo-600 hover:text-indigo-500"
                                >
                                  Remove
                                </button>
                              </div>
                            </div>
                          </div>
                        </li>

                        <!-- More products... -->
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="border-t border-gray-200 px-4 py-6 sm:px-6">
                  <div
                    class="flex justify-between text-base font-medium text-gray-900"
                  >
                    <p>Subtotal</p>
                    <p class="total-cart">0.00</p>
                  </div>
                  <p class="mt-0.5 text-sm text-gray-500">
                    Shipping and taxes calculated at checkout.
                  </p>
                  <div class="mt-6">
                    <button
                      type="button"
                      class="flex items-center justify-center rounded-md border border-transparent btn-block mb-6 clear-cart btn btn-danger"
                      id="removeAll"
                    >
                      Clear cart
                    </button>

                    <a
                      href="#"
                      class="flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-6 py-3 text-base font-medium text-white shadow-sm hover:bg-indigo-700"
                      >Checkout</a
                    >
                  </div>
                  <div
                    class="mt-6 flex justify-center text-center text-sm text-gray-500"
                  >
                    <p>
                      or
                      <button
                        type="button"
                        class="font-medium text-indigo-600 hover:text-indigo-500"
                      >
                        Continue Shopping
                        <span aria-hidden="true"> &rarr;</span>
                      </button>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      id="myShoppingCart"
      class="fixed z-5 top-[45%] right-0 w-20 h-20 text-center bg-blue-500 shadow-md drop-shadow-md rounded-5 cursor-pointer"
    >
      <div class="p-3">
        <i class="fa fa-shopping-basket fa-2x text-white"></i>
        <div class="text-white text-xs">
          <span class="indicator-item total-count">0</span> ITEMS
        </div>
      </div>
      <div class="bg-slate-300 p-1 text-xs">
        <span class="total-cart">0</span> Tk.
      </div>
    </div>
  </body>

  <script src="./assets/js/axios.min.js"></script>
  <script>
    async function getList() {
      // document.getElementById("loader").classList.remove("d-none");
      let URL = "./assets/json/products.json";
      await axios
        .get(URL)
        .then((response) => {
          response.data.products.forEach((item) => {
            let productPrice = (
              item.price -
              (item.price * item.discountPercentage) / 100
            ).toFixed(2);

            document.getElementById("productContent").innerHTML += `
        <div class="bg-white shadow rounded  group">
          <div class="relative  h-[200px] overflow-hidden">
            <img
              src="${item.thumbnail}"
              alt="${item.title}"
              class="w-full  "
            />
            <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100 transition"
            >
              <a
                href="#"
                class="text-white text-lg w-9 h-8 rounded-full bg-primary flex items-center justify-center hover:bg-gray-800 transition"
                title="view product"
              >
                <i class="fa-solid fa-magnifying-glass"></i>
              </a>
              <a
                href="javascript:;"  data-name="${item.id}"
                class="text-white text-lg w-9 h-8 rounded-full bg-primary flex items-center justify-center hover:bg-gray-800 transition"
                title="add to wishlist"
              >
                <i class="fa-solid fa-heart"></i>
              </a>
            </div>
          </div>

          <div class="pt-4 pb-3 px-4  h-[250px] overflow-hidden">
            <a href="#">
              <h4
                class="uppercase font-medium text-xl mb-2 text-gray-800 hover:text-primary transition"
              >
                ${item.title}  <br><span class="text-xs text-gray-500">(${
              item.brand
            })</span>
              </h4>
            </a>
            <div class="text-sm flex text-gray-500  ">${item.description.substring(
              0,
              80
            )} ...</div>
            <div class="flex items-baseline mb-1 space-x-2">
              <p class="text-xl text-primary font-semibold">${productPrice} Tk.</p>
              <p class="text-sm text-gray-400 line-through">${
                item.price
              } Tk.</p>
            </div>


          </div>
          <a   href="javascript:;"  data-thumbnail="${
            item.thumbnail
          }" data-name="${
              item.title
            }" data-price="${productPrice}" data-brand="${item.brand}"
            class="bottom-0 block w-full py-1 text-center text-white bg-primary border border-primary rounded-b hover:bg-transparent hover:text-primary transition addtocart"
            >Add to cart</a>
        </div> `;
            console.log(item.title);
          });
          myCart();
        })
        .catch((err) => {
          dispatch({ type: "FETCH_USERS_REJECTED", payload: err });
        });
    }

    getList(); ////load products from json

    let shoppingCart = (function () {
      cart = [];
      var obj = {};

      function Item(name, price, thumbnail, brand, count) {
        this.name = name;
        this.brand = brand;
        this.price = price;
        this.thumbnail = thumbnail;
        this.count = count;
      }

      // Save cart
      function saveCart() {
        localStorage.setItem("shoppingCart", JSON.stringify(cart));
      }

      // Load cart
      function loadCart() {
        cart = JSON.parse(localStorage.getItem("shoppingCart"));
      }
      if (localStorage.getItem("shoppingCart") != null) {
        loadCart();
      }

      // Add to cart
      obj.addItemToCart = function (name, price, thumbnail, brand, count) {
        for (var item in cart) {
          if (cart[item].name === name) {
            cart[item].count++;
            saveCart();
            return;
          }
        }
        var item = new Item(name, price, thumbnail, brand, count);
        cart.push(item);
        saveCart();
      };

      // Set count from item
      obj.setCountForItem = function (name, count) {
        for (var i in cart) {
          if (cart[i].name === name) {
            cart[i].count = count;
            break;
          }
        }
      };
      // Remove item from cart
      obj.removeItemFromCart = function (name) {
        for (var item in cart) {
          if (cart[item].name === name) {
            cart[item].count--;
            if (cart[item].count === 0) {
              cart.splice(item, 1);
            }
            break;
          }
        }
        saveCart();
      };

      // Remove all items from cart
      obj.removeItemFromCartAll = function (name) {
        for (var item in cart) {
          if (cart[item].name === name) {
            cart.splice(item, 1);
            break;
          }
        }
        saveCart();
      };

      // Clear cart
      obj.clearCart = function () {
        cart = [];
        saveCart();
      };

      // Count cart
      obj.totalCount = function () {
        var totalCount = 0;
        for (var item in cart) {
          totalCount += Number(cart[item].count);
        }
        return totalCount;
      };

      // Total cart
      obj.totalCart = function () {
        var totalCart = 0;
        for (var item in cart) {
          totalCart += cart[item].price * cart[item].count;
        }
        return Number(totalCart.toFixed(2));
      };

      // List cart
      obj.listCart = function () {
        var cartCopy = [];
        for (i in cart) {
          item = cart[i];
          itemCopy = {};
          for (p in item) {
            itemCopy[p] = item[p];
          }
          itemCopy.total = Number(item.price * item.count).toFixed(2);
          cartCopy.push(itemCopy);
        }
        return cartCopy;
      };

      return obj;
    })();

    //////////add to cart//////
    let myCart = () => {
      // Add item

      const addtocart = document.querySelectorAll(".addtocart");
      addtocart.forEach((el) =>
        el.addEventListener("click", (event) => {
          event.preventDefault();
          let thumbnail = event.target.getAttribute("data-thumbnail");
          var name = event.target.getAttribute("data-name");
          var brand = event.target.getAttribute("data-brand");

          var price = Number(event.target.getAttribute("data-price"));
          shoppingCart.addItemToCart(name, price, thumbnail, brand, 1);
          displayCart();
          //console.log(event.target.getAttribute("data-price"));
        })
      );

      // Clear items
      const removeBtn = document.getElementById("removeAll");

      removeBtn.addEventListener("click", () => {
        shoppingCart.clearCart();
        displayCart();
      });

      function displayCart() {
        var cartArray = shoppingCart.listCart();
        var output = "";
        for (var i in cartArray) {
          output += `<li class="flex py-6">
                          <div
                            class="h-10 w-10 flex-shrink-0 overflow-hidden rounded-md border border-gray-200"
                          >
                            <img
                              src="${cartArray[i].thumbnail}"
                              alt="${cartArray[i].name}"
                              class="h-full w-full object-cover object-center"
                            />
                          </div>

                          <div class="ml-4 flex flex-1 flex-col">
                            <div>
                              <div
                                class="flex justify-between text-base font-medium text-gray-900"
                              >
                                <h3>
                                  <a href="#">${cartArray[i].name}</a>
                                </h3>
                                <p class="ml-4"> ${cartArray[i].total} Tk.</p>
                              </div>
                              <p class="mt-1 text-sm text-gray-500"> ${cartArray[i].brand} </p>
                            </div>
                            <div
                              class="flex flex-1 items-end justify-between text-sm"
                            >
                              <p class="text-gray-500">${cartArray[i].price} Tk. X Qty <input type="number" min='1' class="item-count border-solid border-2 border-indigo-300 text-center" style="width:80px"
            data-name="${cartArray[i].name}"  value="${cartArray[i].count}"></p>

                              <div class="flex">
                                <button
                                  type="button" data-name="${cartArray[i].name}"
                                  class="font-medium text-indigo-600 hover:text-indigo-500 delete-item"
                                >
                                  Remove
                                </button>
                              </div>
                            </div>
                          </div>
                        </li>`;
        }
        // let element = document.querySelector(".total-count");
        // element.textContent = "sadfasdf";

        document.querySelector(".show-cart").innerHTML = output;

        document.querySelector(".total-count").innerHTML =
          shoppingCart.totalCount();

        var elements = document.getElementsByClassName("total-cart");
        for (var i = 0; i < elements.length; i++) {
          elements[i].innerHTML = shoppingCart.totalCart();
        }

        deleteCart();
      }

      // Delete item button
      function deleteCart() {
        let deleteItem = document.querySelectorAll(".delete-item");
        deleteItem.forEach((el) =>
          el.addEventListener("click", (event) => {
            event.preventDefault();

            var name = event.target.getAttribute("data-name");

            shoppingCart.removeItemFromCartAll(name);
            displayCart();
          })
        );

        let updateQty = document.querySelectorAll(".item-count");
        updateQty.forEach((el) =>
          el.addEventListener("change", (event) => {
            event.preventDefault();

            var name = event.target.getAttribute("data-name");
            var count = event.target.value;
            shoppingCart.setCountForItem(name, count);
            displayCart();
          })
        );
      }

      displayCart();
    };

    // show right side shoppingcart items
    const myShoppingCart = document.getElementById("myShoppingCart");

    myShoppingCart.addEventListener("click", () => {
      document.getElementById("rightShoppingCart").classList.remove("hidden");
    });
    //////close right side view cart
    const closeCartEvent = document.getElementById("closeCart");
    closeCartEvent.addEventListener("click", () => {
      document.getElementById("rightShoppingCart").classList.add("hidden");
    });
  </script>
</html>
